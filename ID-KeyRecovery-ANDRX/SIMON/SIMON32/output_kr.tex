
\documentclass[varwidth=100cm]{standalone}
\usepackage{tikz}
\usepackage{simon}
\usetikzlibrary {decorations.fractals,spy}
\begin{document}
\begin{figure}
    \centering
    \begin{tikzpicture}[>=latex,fillopts/.style={black},raster/.style={gray!50}, spy using outlines={circle, magnification=3.5, size=1.2cm, connect spies}]
        \simoncompactfalse % vertically less compact layout
        \SimonInit[32]

            \SimonNoKey{1}
                {\MarkCell[red]{s0}\Fill[unknown]{s1}\PattCell[black]{s1}\MarkCell[red]{s1}\MarkCell[red]{s2}\Fill[one]{s3}\MarkCell[red]{s3}\Fill[unknown]{s4}\PattCell[black]{s4}\MarkCell[red]{s4}\Fill[unknown]{s5}\PattCell[black]{s5}\MarkCell[red]{s5}\Fill[unknown]{s6}\PattCell[black]{s6}\MarkCell[red]{s6}\Fill[unknown]{s7}\PattCell[black]{s7}\MarkCell[red]{s7}\Fill[unknown]{s8}\PattCell[black]{s8}\MarkCell[red]{s8}\MarkCell[red]{s9}\MarkCell[red]{s10}\MarkCell[red]{s11}\MarkCell[red]{s12}\Fill[unknown]{s13}\PattCell[black]{s13}\MarkCell[red]{s13}\Fill[unknown]{s14}\PattCell[black]{s14}\MarkCell[red]{s14}\Fill[unknown]{s15}\PattCell[black]{s15}\MarkCell[red]{s15}} % left
                {\Fill[unknown]{s0}\PattCell[black]{s0}\MarkCell[red]{s0}\Fill[one]{s1}\MarkCell[red]{s1}\Fill[unknown]{s2}\PattCell[black]{s2}\MarkCell[red]{s2}\Fill[unknown]{s3}\PattCell[black]{s3}\MarkCell[red]{s3}\Fill[unknown]{s4}\PattCell[black]{s4}\MarkCell[red]{s4}\Fill[unknown]{s5}\PattCell[black]{s5}\MarkCell[red]{s5}\Fill[unknown]{s6}\PattCell[black]{s6}\MarkCell[red]{s6}\Fill[unknown]{s7}\PattCell[black]{s7}\MarkCell[red]{s7}\MarkCell[red]{s8}\Fill[unknown]{s9}\PattCell[black]{s9}\MarkCell[red]{s9}\MarkCell[red]{s10}\Fill[unknown]{s11}\PattCell[black]{s11}\MarkCell[red]{s11}\Fill[unknown]{s12}\PattCell[black]{s12}\MarkCell[red]{s12}\Fill[unknown]{s13}\PattCell[black]{s13}\MarkCell[red]{s13}\Fill[unknown]{s14}\PattCell[black]{s14}\MarkCell[red]{s14}\Fill[unknown]{s15}\PattCell[black]{s15}\MarkCell[red]{s15}} % right
                {\Fill[unknown]{s0}\PattCell[black]{s0}\MarkCell[red]{s0}\MarkCell[red]{s1}\MarkCell[red]{s2}\MarkCell[red]{s3}\MarkCell[red]{s4}\Fill[unknown]{s5}\PattCell[black]{s5}\MarkCell[red]{s5}\Fill[unknown]{s6}\PattCell[black]{s6}\MarkCell[red]{s6}\Fill[unknown]{s7}\PattCell[black]{s7}\MarkCell[red]{s7}\MarkCell[red]{s8}\Fill[unknown]{s9}\PattCell[black]{s9}\MarkCell[red]{s9}\MarkCell[red]{s10}\Fill[one]{s11}\MarkCell[red]{s11}\Fill[unknown]{s12}\PattCell[black]{s12}\MarkCell[red]{s12}\Fill[unknown]{s13}\PattCell[black]{s13}\MarkCell[red]{s13}\Fill[unknown]{s14}\PattCell[black]{s14}\MarkCell[red]{s14}\Fill[unknown]{s15}\PattCell[black]{s15}\MarkCell[red]{s15}} % rot8
                {\Fill[unknown]{s0}\PattCell[black]{s0}\MarkCell[red]{s0}\MarkCell[red]{s1}\Fill[one]{s2}\MarkCell[red]{s2}\Fill[unknown]{s3}\PattCell[black]{s3}\MarkCell[red]{s3}\Fill[unknown]{s4}\PattCell[black]{s4}\MarkCell[red]{s4}\Fill[unknown]{s5}\PattCell[black]{s5}\MarkCell[red]{s5}\Fill[unknown]{s6}\PattCell[black]{s6}\MarkCell[red]{s6}\Fill[unknown]{s7}\PattCell[black]{s7}\MarkCell[red]{s7}\MarkCell[red]{s8}\MarkCell[red]{s9}\MarkCell[red]{s10}\MarkCell[red]{s11}\Fill[unknown]{s12}\PattCell[black]{s12}\MarkCell[red]{s12}\Fill[unknown]{s13}\PattCell[black]{s13}\MarkCell[red]{s13}\Fill[unknown]{s14}\PattCell[black]{s14}\MarkCell[red]{s14}\MarkCell[red]{s15}} % rot1
                {\MarkCell[red]{s0}\Fill[one]{s1}\MarkCell[red]{s1}\Fill[unknown]{s2}\PattCell[black]{s2}\MarkCell[red]{s2}\Fill[unknown]{s3}\PattCell[black]{s3}\MarkCell[red]{s3}\Fill[unknown]{s4}\PattCell[black]{s4}\MarkCell[red]{s4}\Fill[unknown]{s5}\PattCell[black]{s5}\MarkCell[red]{s5}\Fill[unknown]{s6}\PattCell[black]{s6}\MarkCell[red]{s6}\MarkCell[red]{s7}\MarkCell[red]{s8}\MarkCell[red]{s9}\MarkCell[red]{s10}\Fill[unknown]{s11}\PattCell[black]{s11}\MarkCell[red]{s11}\Fill[unknown]{s12}\PattCell[black]{s12}\MarkCell[red]{s12}\Fill[unknown]{s13}\PattCell[black]{s13}\MarkCell[red]{s13}\MarkCell[red]{s14}\Fill[unknown]{s15}\PattCell[black]{s15}\MarkCell[red]{s15}} % rot2
                {\Fill[unknown]{s0}\PattCell[black]{s0}\MarkCell[red]{s0}\MarkCell[red]{s1}\Fill[unknown]{s2}\PattCell[black]{s2}\MarkCell[red]{s2}\Fill[unknown]{s3}\PattCell[black]{s3}\MarkCell[red]{s3}\Fill[unknown]{s4}\PattCell[black]{s4}\MarkCell[red]{s4}\Fill[unknown]{s5}\PattCell[black]{s5}\MarkCell[red]{s5}\Fill[unknown]{s6}\PattCell[black]{s6}\MarkCell[red]{s6}\Fill[unknown]{s7}\PattCell[black]{s7}\MarkCell[red]{s7}\MarkCell[red]{s8}\Fill[unknown]{s9}\PattCell[black]{s9}\MarkCell[red]{s9}\MarkCell[red]{s10}\Fill[unknown]{s11}\PattCell[black]{s11}\MarkCell[red]{s11}\Fill[unknown]{s12}\PattCell[black]{s12}\MarkCell[red]{s12}\Fill[unknown]{s13}\PattCell[black]{s13}\MarkCell[red]{s13}\Fill[unknown]{s14}\PattCell[black]{s14}\MarkCell[red]{s14}\Fill[unknown]{s15}\PattCell[black]{s15}\MarkCell[red]{s15}} % and
                {\Fill[unknown]{s0}\PattCell[black]{s0}\MarkCell[red]{s0}\Fill[one]{s1}\MarkCell[red]{s1}\Fill[unknown]{s2}\PattCell[black]{s2}\MarkCell[red]{s2}\Fill[unknown]{s3}\PattCell[black]{s3}\MarkCell[red]{s3}\Fill[unknown]{s4}\PattCell[black]{s4}\MarkCell[red]{s4}\Fill[unknown]{s5}\PattCell[black]{s5}\MarkCell[red]{s5}\Fill[unknown]{s6}\PattCell[black]{s6}\MarkCell[red]{s6}\Fill[unknown]{s7}\PattCell[black]{s7}\MarkCell[red]{s7}\MarkCell[red]{s8}\Fill[unknown]{s9}\PattCell[black]{s9}\MarkCell[red]{s9}\MarkCell[red]{s10}\Fill[unknown]{s11}\PattCell[black]{s11}\MarkCell[red]{s11}\Fill[unknown]{s12}\PattCell[black]{s12}\MarkCell[red]{s12}\Fill[unknown]{s13}\PattCell[black]{s13}\MarkCell[red]{s13}\Fill[unknown]{s14}\PattCell[black]{s14}\MarkCell[red]{s14}\Fill[unknown]{s15}\PattCell[black]{s15}\MarkCell[red]{s15}} % xor
            \SimonRoundEQ{2}
                {\Fill[unknown]{s0}\PattCell[black]{s0}\MarkCell[red]{s0}\MarkCell[red]{s1}\FrameCell[yellow]{s2}\MarkCell[red]{s2}\FrameCell[yellow]{s3}\MarkCell[red]{s3}\FrameCell[yellow]{s4}\MarkCell[red]{s4}\FrameCell[yellow]{s5}\Fill[one]{s5}\MarkCell[red]{s5}\Fill[unknown]{s6}\PattCell[black]{s6}\MarkCell[red]{s6}\Fill[unknown]{s7}\PattCell[black]{s7}\MarkCell[red]{s7}\MarkCell[red]{s8}\Fill[unknown]{s9}\PattCell[black]{s9}\MarkCell[red]{s9}\MarkCell[red]{s10}\FrameCell[yellow]{s11}\MarkCell[red]{s11}\FrameCell[yellow]{s12}\MarkCell[red]{s12}\FrameCell[yellow]{s13}\MarkCell[red]{s13}\FrameCell[yellow]{s14}\MarkCell[red]{s14}\Fill[unknown]{s15}\PattCell[black]{s15}\MarkCell[red]{s15}} % left
                {\MarkCell[red]{s0}\Fill[unknown]{s1}\PattCell[black]{s1}\MarkCell[red]{s1}\MarkCell[red]{s2}\Fill[one]{s3}\MarkCell[red]{s3}\Fill[unknown]{s4}\PattCell[black]{s4}\MarkCell[red]{s4}\Fill[unknown]{s5}\PattCell[black]{s5}\Fill[unknown]{s6}\PattCell[black]{s6}\Fill[unknown]{s7}\PattCell[black]{s7}\Fill[unknown]{s8}\PattCell[black]{s8}\MarkCell[red]{s8}\MarkCell[red]{s10}\Fill[unknown]{s13}\PattCell[black]{s13}\Fill[unknown]{s14}\PattCell[black]{s14}\MarkCell[red]{s14}\Fill[unknown]{s15}\PattCell[black]{s15}\MarkCell[red]{s15}} % right
                {\MarkCell[red]{s0}\Fill[unknown]{s1}\PattCell[black]{s1}\MarkCell[red]{s1}\MarkCell[red]{s2}\MarkCell[red]{s3}\MarkCell[red]{s4}\MarkCell[red]{s5}\MarkCell[red]{s6}\Fill[unknown]{s7}\PattCell[black]{s7}\Fill[unknown]{s8}\PattCell[black]{s8}\MarkCell[red]{s8}\MarkCell[red]{s10}\Fill[one]{s13}\Fill[unknown]{s14}\PattCell[black]{s14}\MarkCell[red]{s14}\Fill[unknown]{s15}\PattCell[black]{s15}\MarkCell[red]{s15}} % rot8
                {\MarkCell[red]{s0}\MarkCell[red]{s1}\MarkCell[red]{s2}\MarkCell[red]{s3}\Fill[one]{s4}\MarkCell[red]{s4}\Fill[unknown]{s5}\PattCell[black]{s5}\Fill[unknown]{s6}\PattCell[black]{s6}\MarkCell[red]{s7}\Fill[unknown]{s8}\PattCell[black]{s8}\MarkCell[red]{s8}\MarkCell[red]{s10}\MarkCell[red]{s13}\Fill[unknown]{s14}\PattCell[black]{s14}\MarkCell[red]{s14}\Fill[unknown]{s15}\PattCell[black]{s15}\MarkCell[red]{s15}} % rot1
                {\MarkCell[red]{s0}\MarkCell[red]{s1}\MarkCell[red]{s2}\Fill[one]{s3}\MarkCell[red]{s3}\Fill[unknown]{s4}\PattCell[black]{s4}\MarkCell[red]{s4}\Fill[unknown]{s5}\PattCell[black]{s5}\Fill[unknown]{s7}\PattCell[black]{s7}\MarkCell[red]{s8}\MarkCell[red]{s10}\Fill[unknown]{s13}\PattCell[black]{s13}\Fill[unknown]{s14}\PattCell[black]{s14}\MarkCell[red]{s14}\MarkCell[red]{s15}} % rot2
                {\Fill[active]{s0}\Fill[active]{s1}\Fill[active]{s2}\Fill[active]{s3}\Fill[active]{s4}\Fill[active]{s5}\Fill[active]{s6}\Fill[active]{s7}\Fill[active]{s8}\Fill[active]{s9}\Fill[active]{s10}\Fill[active]{s11}\Fill[active]{s12}\Fill[active]{s13}\Fill[active]{s14}\Fill[active]{s15}} % key
                {\MarkCell[red]{s0}\Fill[unknown]{s1}\PattCell[black]{s1}\MarkCell[red]{s1}\MarkCell[red]{s2}\MarkCell[red]{s3}\Fill[unknown]{s4}\PattCell[black]{s4}\MarkCell[red]{s4}\Fill[unknown]{s5}\PattCell[black]{s5}\Fill[unknown]{s6}\PattCell[black]{s6}\Fill[unknown]{s7}\PattCell[black]{s7}\Fill[unknown]{s8}\PattCell[black]{s8}\MarkCell[red]{s8}\MarkCell[red]{s10}\Fill[unknown]{s13}\PattCell[black]{s13}\Fill[unknown]{s14}\PattCell[black]{s14}\MarkCell[red]{s14}\Fill[unknown]{s15}\PattCell[black]{s15}\MarkCell[red]{s15}} % and
                {\MarkCell[red]{s0}\Fill[unknown]{s1}\PattCell[black]{s1}\MarkCell[red]{s1}\MarkCell[red]{s2}\Fill[one]{s3}\MarkCell[red]{s3}\Fill[unknown]{s4}\PattCell[black]{s4}\MarkCell[red]{s4}\Fill[unknown]{s5}\PattCell[black]{s5}\Fill[unknown]{s6}\PattCell[black]{s6}\Fill[unknown]{s7}\PattCell[black]{s7}\Fill[unknown]{s8}\PattCell[black]{s8}\MarkCell[red]{s8}\MarkCell[red]{s10}\Fill[unknown]{s13}\PattCell[black]{s13}\Fill[unknown]{s14}\PattCell[black]{s14}\MarkCell[red]{s14}\Fill[unknown]{s15}\PattCell[black]{s15}\MarkCell[red]{s15}} % xor

            \SimonRoundEQ{3}
                {\MarkCell[red]{s0}\Fill[unknown]{s1}\PattCell[black]{s1}\MarkCell[red]{s1}\MarkCell[red]{s2}\MarkCell[red]{s3}\FrameCell[yellow]{s4}\MarkCell[red]{s4}\FrameCell[yellow]{s5}\FrameCell[yellow]{s6}\FrameCell[yellow]{s7}\Fill[one]{s7}\Fill[unknown]{s8}\PattCell[black]{s8}\MarkCell[red]{s8}\MarkCell[red]{s10}\FrameCell[yellow]{s13}\FrameCell[yellow]{s14}\MarkCell[red]{s14}\FrameCell[yellow]{s15}\MarkCell[red]{s15}} % left
                {\Fill[unknown]{s0}\PattCell[black]{s0}\MarkCell[red]{s0}\MarkCell[red]{s2}\Fill[one]{s5}\Fill[unknown]{s6}\PattCell[black]{s6}\Fill[unknown]{s7}\PattCell[black]{s7}\Fill[unknown]{s9}\PattCell[black]{s9}\Fill[unknown]{s15}\PattCell[black]{s15}} % right
                {\Fill[unknown]{s0}\PattCell[black]{s0}\MarkCell[red]{s0}\MarkCell[red]{s2}\MarkCell[red]{s6}\MarkCell[red]{s7}\Fill[unknown]{s9}\PattCell[black]{s9}\Fill[one]{s15}} % rot8
                {\Fill[unknown]{s0}\PattCell[black]{s0}\MarkCell[red]{s0}\MarkCell[red]{s2}\Fill[one]{s6}\Fill[unknown]{s7}\PattCell[black]{s7}\MarkCell[red]{s9}\MarkCell[red]{s15}} % rot1
                {\MarkCell[red]{s0}\MarkCell[red]{s2}\Fill[one]{s5}\Fill[unknown]{s6}\PattCell[black]{s6}\Fill[unknown]{s15}\PattCell[black]{s15}} % rot2
                {\Fill[active]{s0}\Fill[active]{s1}\Fill[active]{s3}\Fill[active]{s8}\Fill[active]{s10}\Fill[active]{s14}\Fill[active]{s15}} % key
                {\Fill[unknown]{s0}\PattCell[black]{s0}\MarkCell[red]{s0}\MarkCell[red]{s2}\Fill[unknown]{s6}\PattCell[black]{s6}\Fill[unknown]{s7}\PattCell[black]{s7}\Fill[unknown]{s9}\PattCell[black]{s9}\Fill[unknown]{s15}\PattCell[black]{s15}} % and
                {\Fill[unknown]{s0}\PattCell[black]{s0}\MarkCell[red]{s0}\MarkCell[red]{s2}\Fill[one]{s5}\Fill[unknown]{s6}\PattCell[black]{s6}\Fill[unknown]{s7}\PattCell[black]{s7}\Fill[unknown]{s9}\PattCell[black]{s9}\Fill[unknown]{s15}\PattCell[black]{s15}} % xor

            \SimonRoundEQ{4}
                {\FrameCell[yellow]{s0}\MarkCell[red]{s0}\MarkCell[red]{s2}\FrameCell[yellow]{s6}\FrameCell[yellow]{s7}\FrameCell[yellow]{s9}\Fill[one]{s9}\FrameCell[yellow]{s15}} % left
                {\Fill[unknown]{s1}\PattCell[black]{s1}\Fill[one]{s7}\Fill[unknown]{s8}\PattCell[black]{s8}} % right
                {\Fill[one]{s1}\MarkCell[red]{s8}} % rot8
                {\MarkCell[red]{s1}\Fill[one]{s8}} % rot1
                {\Fill[one]{s7}} % rot2
                {\Fill[active]{s0}\Fill[active]{s2}} % key
                {\Fill[unknown]{s1}\PattCell[black]{s1}\Fill[unknown]{s8}\PattCell[black]{s8}} % and
                {\Fill[unknown]{s1}\PattCell[black]{s1}\Fill[one]{s7}\Fill[unknown]{s8}\PattCell[black]{s8}} % xor

            \SimonBlackBox[5-round ID distinguisher]{5}
                {\FrameCell[yellow]{s1}\FrameCell[yellow]{s8}} % left
                {\Fill[one]{s9}} % right

            \SimonRoundEQ{10}
                {\Fill[one]{s2}} % left
                {\FrameCell[yellow]{s1}\FrameCell[yellow]{s10}} % right
                {\MarkCell[red]{s1}\Fill[one]{s10}} % rot8
                {\Fill[one]{s1}\MarkCell[red]{s10}} % rot1
                {\Fill[one]{s0}} % rot2
                {} % key
                {\Fill[unknown]{s1}\PattCell[black]{s1}\Fill[unknown]{s10}\PattCell[black]{s10}} % and
                {\Fill[one]{s0}\Fill[unknown]{s1}\PattCell[black]{s1}\Fill[unknown]{s10}\PattCell[black]{s10}} % xor

            \SimonRoundEQ{11}
                {\Fill[one]{s0}\Fill[unknown]{s1}\PattCell[black]{s1}\Fill[unknown]{s10}\PattCell[black]{s10}} % left
                {\FrameCell[yellow]{s0}\FrameCell[yellow]{s2}\Fill[one]{s2}\FrameCell[yellow]{s8}\FrameCell[yellow]{s9}\MarkCell[red]{s9}\MarkCell[red]{s11}\FrameCell[yellow]{s15}} % right
                {\MarkCell[red]{s0}\Fill[unknown]{s2}\PattCell[black]{s2}\Fill[one]{s8}\Fill[unknown]{s9}\PattCell[black]{s9}\MarkCell[red]{s9}\MarkCell[red]{s11}\MarkCell[red]{s15}} % rot8
                {\Fill[unknown]{s0}\PattCell[black]{s0}\MarkCell[red]{s2}\MarkCell[red]{s8}\Fill[unknown]{s9}\PattCell[black]{s9}\MarkCell[red]{s9}\MarkCell[red]{s11}\Fill[one]{s15}} % rot1
                {\Fill[unknown]{s8}\PattCell[black]{s8}\MarkCell[red]{s9}\MarkCell[red]{s11}\Fill[one]{s14}\Fill[unknown]{s15}\PattCell[black]{s15}} % rot2
                {} % key
                {\Fill[unknown]{s0}\PattCell[black]{s0}\Fill[unknown]{s2}\PattCell[black]{s2}\Fill[unknown]{s8}\PattCell[black]{s8}\Fill[unknown]{s9}\PattCell[black]{s9}\MarkCell[red]{s9}\MarkCell[red]{s11}\Fill[unknown]{s15}\PattCell[black]{s15}} % and
                {\Fill[unknown]{s0}\PattCell[black]{s0}\Fill[unknown]{s2}\PattCell[black]{s2}\Fill[unknown]{s8}\PattCell[black]{s8}\Fill[unknown]{s9}\PattCell[black]{s9}\MarkCell[red]{s9}\MarkCell[red]{s11}\Fill[one]{s14}\Fill[unknown]{s15}\PattCell[black]{s15}} % xor

            \SimonRoundEQ{12}
                {\Fill[unknown]{s0}\PattCell[black]{s0}\Fill[unknown]{s2}\PattCell[black]{s2}\Fill[unknown]{s8}\PattCell[black]{s8}\Fill[unknown]{s9}\PattCell[black]{s9}\MarkCell[red]{s9}\MarkCell[red]{s11}\Fill[one]{s14}\Fill[unknown]{s15}\PattCell[black]{s15}} % left
                {\FrameCell[yellow]{s0}\Fill[one]{s0}\Fill[unknown]{s1}\PattCell[black]{s1}\MarkCell[red]{s1}\MarkCell[red]{s3}\FrameCell[yellow]{s6}\FrameCell[yellow]{s7}\MarkCell[red]{s7}\FrameCell[yellow]{s8}\MarkCell[red]{s8}\MarkCell[red]{s9}\Fill[unknown]{s10}\PattCell[black]{s10}\MarkCell[red]{s10}\MarkCell[red]{s11}\MarkCell[red]{s12}\FrameCell[yellow]{s13}\MarkCell[red]{s13}\FrameCell[yellow]{s14}\FrameCell[yellow]{s15}} % right
                {\Fill[unknown]{s0}\PattCell[black]{s0}\Fill[unknown]{s1}\PattCell[black]{s1}\MarkCell[red]{s1}\MarkCell[red]{s3}\Fill[one]{s6}\Fill[unknown]{s7}\PattCell[black]{s7}\MarkCell[red]{s7}\Fill[unknown]{s8}\PattCell[black]{s8}\MarkCell[red]{s8}\MarkCell[red]{s9}\Fill[unknown]{s10}\PattCell[black]{s10}\MarkCell[red]{s10}\MarkCell[red]{s11}\MarkCell[red]{s12}\MarkCell[red]{s13}\MarkCell[red]{s14}\MarkCell[red]{s15}} % rot8
                {\MarkCell[red]{s0}\Fill[unknown]{s1}\PattCell[black]{s1}\MarkCell[red]{s1}\MarkCell[red]{s3}\MarkCell[red]{s6}\Fill[unknown]{s7}\PattCell[black]{s7}\MarkCell[red]{s7}\Fill[unknown]{s8}\PattCell[black]{s8}\MarkCell[red]{s8}\MarkCell[red]{s9}\MarkCell[red]{s10}\MarkCell[red]{s11}\MarkCell[red]{s12}\Fill[one]{s13}\MarkCell[red]{s13}\Fill[unknown]{s14}\PattCell[black]{s14}\Fill[unknown]{s15}\PattCell[black]{s15}} % rot1
                {\Fill[unknown]{s0}\PattCell[black]{s0}\MarkCell[red]{s1}\MarkCell[red]{s3}\Fill[unknown]{s6}\PattCell[black]{s6}\Fill[unknown]{s7}\PattCell[black]{s7}\MarkCell[red]{s7}\MarkCell[red]{s8}\MarkCell[red]{s9}\MarkCell[red]{s10}\MarkCell[red]{s11}\Fill[one]{s12}\MarkCell[red]{s12}\Fill[unknown]{s13}\PattCell[black]{s13}\MarkCell[red]{s13}\Fill[unknown]{s14}\PattCell[black]{s14}} % rot2
                {} % key
                {\Fill[unknown]{s0}\PattCell[black]{s0}\Fill[unknown]{s1}\PattCell[black]{s1}\MarkCell[red]{s1}\MarkCell[red]{s3}\Fill[unknown]{s6}\PattCell[black]{s6}\Fill[unknown]{s7}\PattCell[black]{s7}\MarkCell[red]{s7}\Fill[unknown]{s8}\PattCell[black]{s8}\MarkCell[red]{s8}\MarkCell[red]{s9}\Fill[unknown]{s10}\PattCell[black]{s10}\MarkCell[red]{s10}\MarkCell[red]{s11}\MarkCell[red]{s12}\Fill[unknown]{s13}\PattCell[black]{s13}\MarkCell[red]{s13}\Fill[unknown]{s14}\PattCell[black]{s14}\Fill[unknown]{s15}\PattCell[black]{s15}} % and
                {\Fill[unknown]{s0}\PattCell[black]{s0}\Fill[unknown]{s1}\PattCell[black]{s1}\MarkCell[red]{s1}\MarkCell[red]{s3}\Fill[unknown]{s6}\PattCell[black]{s6}\Fill[unknown]{s7}\PattCell[black]{s7}\MarkCell[red]{s7}\Fill[unknown]{s8}\PattCell[black]{s8}\MarkCell[red]{s8}\MarkCell[red]{s9}\Fill[unknown]{s10}\PattCell[black]{s10}\MarkCell[red]{s10}\MarkCell[red]{s11}\Fill[one]{s12}\MarkCell[red]{s12}\Fill[unknown]{s13}\PattCell[black]{s13}\MarkCell[red]{s13}\Fill[unknown]{s14}\PattCell[black]{s14}\Fill[unknown]{s15}\PattCell[black]{s15}} % xor

            \SimonRoundEQ{13}
                {\Fill[unknown]{s0}\PattCell[black]{s0}\Fill[unknown]{s1}\PattCell[black]{s1}\MarkCell[red]{s1}\MarkCell[red]{s3}\Fill[unknown]{s6}\PattCell[black]{s6}\Fill[unknown]{s7}\PattCell[black]{s7}\MarkCell[red]{s7}\Fill[unknown]{s8}\PattCell[black]{s8}\MarkCell[red]{s8}\MarkCell[red]{s9}\Fill[unknown]{s10}\PattCell[black]{s10}\MarkCell[red]{s10}\MarkCell[red]{s11}\Fill[one]{s12}\MarkCell[red]{s12}\Fill[unknown]{s13}\PattCell[black]{s13}\MarkCell[red]{s13}\Fill[unknown]{s14}\PattCell[black]{s14}\Fill[unknown]{s15}\PattCell[black]{s15}} % left
                {\Fill[unknown]{s0}\PattCell[black]{s0}\MarkCell[red]{s0}\MarkCell[red]{s1}\Fill[unknown]{s2}\PattCell[black]{s2}\MarkCell[red]{s2}\MarkCell[red]{s3}\FrameCell[yellow]{s4}\MarkCell[red]{s4}\FrameCell[yellow]{s5}\MarkCell[red]{s5}\FrameCell[yellow]{s6}\MarkCell[red]{s6}\FrameCell[yellow]{s7}\MarkCell[red]{s7}\Fill[unknown]{s8}\PattCell[black]{s8}\MarkCell[red]{s8}\Fill[unknown]{s9}\PattCell[black]{s9}\MarkCell[red]{s9}\MarkCell[red]{s10}\FrameCell[yellow]{s11}\MarkCell[red]{s11}\FrameCell[yellow]{s12}\MarkCell[red]{s12}\FrameCell[yellow]{s13}\MarkCell[red]{s13}\FrameCell[yellow]{s14}\Fill[one]{s14}\MarkCell[red]{s14}\Fill[unknown]{s15}\PattCell[black]{s15}\MarkCell[red]{s15}} % right
                {\Fill[unknown]{s0}\PattCell[black]{s0}\MarkCell[red]{s0}\MarkCell[red]{s1}\Fill[unknown]{s2}\PattCell[black]{s2}\MarkCell[red]{s2}\MarkCell[red]{s3}\Fill[one]{s4}\MarkCell[red]{s4}\Fill[unknown]{s5}\PattCell[black]{s5}\MarkCell[red]{s5}\Fill[unknown]{s6}\PattCell[black]{s6}\MarkCell[red]{s6}\Fill[unknown]{s7}\PattCell[black]{s7}\MarkCell[red]{s7}\Fill[unknown]{s8}\PattCell[black]{s8}\MarkCell[red]{s8}\Fill[unknown]{s9}\PattCell[black]{s9}\MarkCell[red]{s9}\MarkCell[red]{s10}\MarkCell[red]{s11}\MarkCell[red]{s12}\MarkCell[red]{s13}\Fill[unknown]{s14}\PattCell[black]{s14}\MarkCell[red]{s14}\Fill[unknown]{s15}\PattCell[black]{s15}\MarkCell[red]{s15}} % rot8
                {\Fill[unknown]{s0}\PattCell[black]{s0}\MarkCell[red]{s0}\MarkCell[red]{s1}\MarkCell[red]{s2}\MarkCell[red]{s3}\MarkCell[red]{s4}\Fill[unknown]{s5}\PattCell[black]{s5}\MarkCell[red]{s5}\Fill[unknown]{s6}\PattCell[black]{s6}\MarkCell[red]{s6}\Fill[unknown]{s7}\PattCell[black]{s7}\MarkCell[red]{s7}\MarkCell[red]{s8}\Fill[unknown]{s9}\PattCell[black]{s9}\MarkCell[red]{s9}\MarkCell[red]{s10}\Fill[one]{s11}\MarkCell[red]{s11}\Fill[unknown]{s12}\PattCell[black]{s12}\MarkCell[red]{s12}\Fill[unknown]{s13}\PattCell[black]{s13}\MarkCell[red]{s13}\Fill[unknown]{s14}\PattCell[black]{s14}\MarkCell[red]{s14}\Fill[unknown]{s15}\PattCell[black]{s15}\MarkCell[red]{s15}} % rot1
                {\MarkCell[red]{s0}\MarkCell[red]{s1}\MarkCell[red]{s2}\MarkCell[red]{s3}\Fill[unknown]{s4}\PattCell[black]{s4}\MarkCell[red]{s4}\Fill[unknown]{s5}\PattCell[black]{s5}\MarkCell[red]{s5}\Fill[unknown]{s6}\PattCell[black]{s6}\MarkCell[red]{s6}\MarkCell[red]{s7}\Fill[unknown]{s8}\PattCell[black]{s8}\MarkCell[red]{s8}\MarkCell[red]{s9}\Fill[one]{s10}\MarkCell[red]{s10}\Fill[unknown]{s11}\PattCell[black]{s11}\MarkCell[red]{s11}\Fill[unknown]{s12}\PattCell[black]{s12}\MarkCell[red]{s12}\Fill[unknown]{s13}\PattCell[black]{s13}\MarkCell[red]{s13}\Fill[unknown]{s14}\PattCell[black]{s14}\MarkCell[red]{s14}\Fill[unknown]{s15}\PattCell[black]{s15}\MarkCell[red]{s15}} % rot2
                {} % key
                {\Fill[unknown]{s0}\PattCell[black]{s0}\MarkCell[red]{s0}\MarkCell[red]{s1}\Fill[unknown]{s2}\PattCell[black]{s2}\MarkCell[red]{s2}\MarkCell[red]{s3}\Fill[unknown]{s4}\PattCell[black]{s4}\MarkCell[red]{s4}\Fill[unknown]{s5}\PattCell[black]{s5}\MarkCell[red]{s5}\Fill[unknown]{s6}\PattCell[black]{s6}\MarkCell[red]{s6}\Fill[unknown]{s7}\PattCell[black]{s7}\MarkCell[red]{s7}\Fill[unknown]{s8}\PattCell[black]{s8}\MarkCell[red]{s8}\Fill[unknown]{s9}\PattCell[black]{s9}\MarkCell[red]{s9}\MarkCell[red]{s10}\Fill[unknown]{s11}\PattCell[black]{s11}\MarkCell[red]{s11}\Fill[unknown]{s12}\PattCell[black]{s12}\MarkCell[red]{s12}\Fill[unknown]{s13}\PattCell[black]{s13}\MarkCell[red]{s13}\Fill[unknown]{s14}\PattCell[black]{s14}\MarkCell[red]{s14}\Fill[unknown]{s15}\PattCell[black]{s15}\MarkCell[red]{s15}} % and
                {\Fill[unknown]{s0}\PattCell[black]{s0}\MarkCell[red]{s0}\MarkCell[red]{s1}\Fill[unknown]{s2}\PattCell[black]{s2}\MarkCell[red]{s2}\MarkCell[red]{s3}\Fill[unknown]{s4}\PattCell[black]{s4}\MarkCell[red]{s4}\Fill[unknown]{s5}\PattCell[black]{s5}\MarkCell[red]{s5}\Fill[unknown]{s6}\PattCell[black]{s6}\MarkCell[red]{s6}\Fill[unknown]{s7}\PattCell[black]{s7}\MarkCell[red]{s7}\Fill[unknown]{s8}\PattCell[black]{s8}\MarkCell[red]{s8}\Fill[unknown]{s9}\PattCell[black]{s9}\MarkCell[red]{s9}\Fill[one]{s10}\MarkCell[red]{s10}\Fill[unknown]{s11}\PattCell[black]{s11}\MarkCell[red]{s11}\Fill[unknown]{s12}\PattCell[black]{s12}\MarkCell[red]{s12}\Fill[unknown]{s13}\PattCell[black]{s13}\MarkCell[red]{s13}\Fill[unknown]{s14}\PattCell[black]{s14}\MarkCell[red]{s14}\Fill[unknown]{s15}\PattCell[black]{s15}\MarkCell[red]{s15}} % xor

            \SimonNoKey{14}
                {\Fill[unknown]{s0}\PattCell[black]{s0}\MarkCell[red]{s0}\MarkCell[red]{s1}\Fill[unknown]{s2}\PattCell[black]{s2}\MarkCell[red]{s2}\MarkCell[red]{s3}\Fill[unknown]{s4}\PattCell[black]{s4}\MarkCell[red]{s4}\Fill[unknown]{s5}\PattCell[black]{s5}\MarkCell[red]{s5}\Fill[unknown]{s6}\PattCell[black]{s6}\MarkCell[red]{s6}\Fill[unknown]{s7}\PattCell[black]{s7}\MarkCell[red]{s7}\Fill[unknown]{s8}\PattCell[black]{s8}\MarkCell[red]{s8}\Fill[unknown]{s9}\PattCell[black]{s9}\MarkCell[red]{s9}\Fill[one]{s10}\MarkCell[red]{s10}\Fill[unknown]{s11}\PattCell[black]{s11}\MarkCell[red]{s11}\Fill[unknown]{s12}\PattCell[black]{s12}\MarkCell[red]{s12}\Fill[unknown]{s13}\PattCell[black]{s13}\MarkCell[red]{s13}\Fill[unknown]{s14}\PattCell[black]{s14}\MarkCell[red]{s14}\Fill[unknown]{s15}\PattCell[black]{s15}\MarkCell[red]{s15}} % left
                {\Fill[unknown]{s0}\PattCell[black]{s0}\MarkCell[red]{s0}\Fill[unknown]{s1}\PattCell[black]{s1}\MarkCell[red]{s1}\FrameCell[yellow]{s2}\MarkCell[red]{s2}\FrameCell[yellow]{s3}\MarkCell[red]{s3}\FrameCell[yellow]{s4}\MarkCell[red]{s4}\FrameCell[yellow]{s5}\MarkCell[red]{s5}\Fill[unknown]{s6}\PattCell[black]{s6}\MarkCell[red]{s6}\Fill[unknown]{s7}\PattCell[black]{s7}\MarkCell[red]{s7}\Fill[unknown]{s8}\PattCell[black]{s8}\MarkCell[red]{s8}\FrameCell[yellow]{s9}\MarkCell[red]{s9}\Fill[unknown]{s10}\PattCell[black]{s10}\MarkCell[red]{s10}\FrameCell[yellow]{s11}\MarkCell[red]{s11}\FrameCell[yellow]{s12}\Fill[one]{s12}\MarkCell[red]{s12}\Fill[unknown]{s13}\PattCell[black]{s13}\MarkCell[red]{s13}\Fill[unknown]{s14}\PattCell[black]{s14}\MarkCell[red]{s14}\Fill[unknown]{s15}\PattCell[black]{s15}\MarkCell[red]{s15}} % right
                {\Fill[unknown]{s0}\PattCell[black]{s0}\MarkCell[red]{s0}\Fill[unknown]{s1}\PattCell[black]{s1}\MarkCell[red]{s1}\Fill[one]{s2}\MarkCell[red]{s2}\Fill[unknown]{s3}\PattCell[black]{s3}\MarkCell[red]{s3}\Fill[unknown]{s4}\PattCell[black]{s4}\MarkCell[red]{s4}\Fill[unknown]{s5}\PattCell[black]{s5}\MarkCell[red]{s5}\Fill[unknown]{s6}\PattCell[black]{s6}\MarkCell[red]{s6}\Fill[unknown]{s7}\PattCell[black]{s7}\MarkCell[red]{s7}\Fill[unknown]{s8}\PattCell[black]{s8}\MarkCell[red]{s8}\MarkCell[red]{s9}\Fill[unknown]{s10}\PattCell[black]{s10}\MarkCell[red]{s10}\MarkCell[red]{s11}\Fill[unknown]{s12}\PattCell[black]{s12}\MarkCell[red]{s12}\Fill[unknown]{s13}\PattCell[black]{s13}\MarkCell[red]{s13}\Fill[unknown]{s14}\PattCell[black]{s14}\MarkCell[red]{s14}\Fill[unknown]{s15}\PattCell[black]{s15}\MarkCell[red]{s15}} % rot8
                {\MarkCell[red]{s0}\Fill[unknown]{s1}\PattCell[black]{s1}\MarkCell[red]{s1}\MarkCell[red]{s2}\Fill[unknown]{s3}\PattCell[black]{s3}\MarkCell[red]{s3}\Fill[unknown]{s4}\PattCell[black]{s4}\MarkCell[red]{s4}\Fill[unknown]{s5}\PattCell[black]{s5}\MarkCell[red]{s5}\Fill[unknown]{s6}\PattCell[black]{s6}\MarkCell[red]{s6}\Fill[unknown]{s7}\PattCell[black]{s7}\MarkCell[red]{s7}\Fill[unknown]{s8}\PattCell[black]{s8}\MarkCell[red]{s8}\Fill[one]{s9}\MarkCell[red]{s9}\Fill[unknown]{s10}\PattCell[black]{s10}\MarkCell[red]{s10}\Fill[unknown]{s11}\PattCell[black]{s11}\MarkCell[red]{s11}\Fill[unknown]{s12}\PattCell[black]{s12}\MarkCell[red]{s12}\Fill[unknown]{s13}\PattCell[black]{s13}\MarkCell[red]{s13}\Fill[unknown]{s14}\PattCell[black]{s14}\MarkCell[red]{s14}\Fill[unknown]{s15}\PattCell[black]{s15}\MarkCell[red]{s15}} % rot1
                {\Fill[unknown]{s0}\PattCell[black]{s0}\MarkCell[red]{s0}\MarkCell[red]{s1}\Fill[unknown]{s2}\PattCell[black]{s2}\MarkCell[red]{s2}\Fill[unknown]{s3}\PattCell[black]{s3}\MarkCell[red]{s3}\Fill[unknown]{s4}\PattCell[black]{s4}\MarkCell[red]{s4}\Fill[unknown]{s5}\PattCell[black]{s5}\MarkCell[red]{s5}\Fill[unknown]{s6}\PattCell[black]{s6}\MarkCell[red]{s6}\Fill[unknown]{s7}\PattCell[black]{s7}\MarkCell[red]{s7}\Fill[one]{s8}\MarkCell[red]{s8}\Fill[unknown]{s9}\PattCell[black]{s9}\MarkCell[red]{s9}\Fill[unknown]{s10}\PattCell[black]{s10}\MarkCell[red]{s10}\Fill[unknown]{s11}\PattCell[black]{s11}\MarkCell[red]{s11}\Fill[unknown]{s12}\PattCell[black]{s12}\MarkCell[red]{s12}\Fill[unknown]{s13}\PattCell[black]{s13}\MarkCell[red]{s13}\Fill[unknown]{s14}\PattCell[black]{s14}\MarkCell[red]{s14}\MarkCell[red]{s15}} % rot2
                {\Fill[unknown]{s0}\PattCell[black]{s0}\MarkCell[red]{s0}\Fill[unknown]{s1}\PattCell[black]{s1}\MarkCell[red]{s1}\Fill[unknown]{s2}\PattCell[black]{s2}\MarkCell[red]{s2}\Fill[unknown]{s3}\PattCell[black]{s3}\MarkCell[red]{s3}\Fill[unknown]{s4}\PattCell[black]{s4}\MarkCell[red]{s4}\Fill[unknown]{s5}\PattCell[black]{s5}\MarkCell[red]{s5}\Fill[unknown]{s6}\PattCell[black]{s6}\MarkCell[red]{s6}\Fill[unknown]{s7}\PattCell[black]{s7}\MarkCell[red]{s7}\Fill[unknown]{s8}\PattCell[black]{s8}\MarkCell[red]{s8}\Fill[unknown]{s9}\PattCell[black]{s9}\MarkCell[red]{s9}\Fill[unknown]{s10}\PattCell[black]{s10}\MarkCell[red]{s10}\Fill[unknown]{s11}\PattCell[black]{s11}\MarkCell[red]{s11}\Fill[unknown]{s12}\PattCell[black]{s12}\MarkCell[red]{s12}\Fill[unknown]{s13}\PattCell[black]{s13}\MarkCell[red]{s13}\Fill[unknown]{s14}\PattCell[black]{s14}\MarkCell[red]{s14}\Fill[unknown]{s15}\PattCell[black]{s15}\MarkCell[red]{s15}} % and
                {\Fill[unknown]{s0}\PattCell[black]{s0}\MarkCell[red]{s0}\Fill[unknown]{s1}\PattCell[black]{s1}\MarkCell[red]{s1}\Fill[unknown]{s2}\PattCell[black]{s2}\MarkCell[red]{s2}\Fill[unknown]{s3}\PattCell[black]{s3}\MarkCell[red]{s3}\Fill[unknown]{s4}\PattCell[black]{s4}\MarkCell[red]{s4}\Fill[unknown]{s5}\PattCell[black]{s5}\MarkCell[red]{s5}\Fill[unknown]{s6}\PattCell[black]{s6}\MarkCell[red]{s6}\Fill[unknown]{s7}\PattCell[black]{s7}\MarkCell[red]{s7}\Fill[unknown]{s8}\PattCell[black]{s8}\MarkCell[red]{s8}\Fill[unknown]{s9}\PattCell[black]{s9}\MarkCell[red]{s9}\Fill[unknown]{s10}\PattCell[black]{s10}\MarkCell[red]{s10}\Fill[unknown]{s11}\PattCell[black]{s11}\MarkCell[red]{s11}\Fill[unknown]{s12}\PattCell[black]{s12}\MarkCell[red]{s12}\Fill[unknown]{s13}\PattCell[black]{s13}\MarkCell[red]{s13}\Fill[unknown]{s14}\PattCell[black]{s14}\MarkCell[red]{s14}\Fill[unknown]{s15}\PattCell[black]{s15}\MarkCell[red]{s15}} % xor

            \SimonFinal{15}
                {\Fill[unknown]{s0}\PattCell[black]{s0}\MarkCell[red]{s0}\Fill[unknown]{s1}\PattCell[black]{s1}\MarkCell[red]{s1}\Fill[unknown]{s2}\PattCell[black]{s2}\MarkCell[red]{s2}\Fill[unknown]{s3}\PattCell[black]{s3}\MarkCell[red]{s3}\Fill[unknown]{s4}\PattCell[black]{s4}\MarkCell[red]{s4}\Fill[unknown]{s5}\PattCell[black]{s5}\MarkCell[red]{s5}\Fill[unknown]{s6}\PattCell[black]{s6}\MarkCell[red]{s6}\Fill[unknown]{s7}\PattCell[black]{s7}\MarkCell[red]{s7}\Fill[unknown]{s8}\PattCell[black]{s8}\MarkCell[red]{s8}\Fill[unknown]{s9}\PattCell[black]{s9}\MarkCell[red]{s9}\Fill[unknown]{s10}\PattCell[black]{s10}\MarkCell[red]{s10}\Fill[unknown]{s11}\PattCell[black]{s11}\MarkCell[red]{s11}\Fill[unknown]{s12}\PattCell[black]{s12}\MarkCell[red]{s12}\Fill[unknown]{s13}\PattCell[black]{s13}\MarkCell[red]{s13}\Fill[unknown]{s14}\PattCell[black]{s14}\MarkCell[red]{s14}\Fill[unknown]{s15}\PattCell[black]{s15}\MarkCell[red]{s15}} % left
                {\Fill[unknown]{s0}\PattCell[black]{s0}\MarkCell[red]{s0}\MarkCell[red]{s1}\Fill[unknown]{s2}\PattCell[black]{s2}\MarkCell[red]{s2}\MarkCell[red]{s3}\Fill[unknown]{s4}\PattCell[black]{s4}\MarkCell[red]{s4}\Fill[unknown]{s5}\PattCell[black]{s5}\MarkCell[red]{s5}\Fill[unknown]{s6}\PattCell[black]{s6}\MarkCell[red]{s6}\Fill[unknown]{s7}\PattCell[black]{s7}\MarkCell[red]{s7}\Fill[unknown]{s8}\PattCell[black]{s8}\MarkCell[red]{s8}\Fill[unknown]{s9}\PattCell[black]{s9}\MarkCell[red]{s9}\Fill[one]{s10}\MarkCell[red]{s10}\Fill[unknown]{s11}\PattCell[black]{s11}\MarkCell[red]{s11}\Fill[unknown]{s12}\PattCell[black]{s12}\MarkCell[red]{s12}\Fill[unknown]{s13}\PattCell[black]{s13}\MarkCell[red]{s13}\Fill[unknown]{s14}\PattCell[black]{s14}\MarkCell[red]{s14}\Fill[unknown]{s15}\PattCell[black]{s15}\MarkCell[red]{s15}} % right
    \end{tikzpicture}
\end{figure}
\end{document}
